<div align="center">
  <img src="assets/govalid-icon.svg" alt="govalid" width="128" height="128">
  <h1>govalid</h1>
  <p><strong>Blazing fast, compile-time type-safe validation for Go</strong></p>
  
  ![Go Version](https://img.shields.io/badge/Go-1.21+-blue.svg)
  ![License](https://img.shields.io/badge/license-MIT-green.svg)
  ![Build Status](https://img.shields.io/badge/build-passing-brightgreen.svg)
</div>

---

## 🚀 Overview

govalid generates **type-safe validation code** at compile time using struct field markers. No reflection, no runtime overhead, just blazing fast validation.

## ⚡ Why govalid?

### 🎯 Performance Benefits
- **Zero allocations**: All validation functions perform zero heap allocations
- **5x to 44x faster**: Significantly outperforms reflection-based validators
- **Compile-time optimization**: Generated code is optimized by the Go compiler

### 👨‍💻 Developer Experience
- **Type safety**: Validation functions are generated with proper types, eliminating runtime reflection
- **Compile-time errors**: Invalid validation rules are caught during code generation, not at runtime
- **No runtime dependencies**: Generated code has minimal external dependencies

### 🔧 Comprehensive Go Support
- **Full collection support**: Maps and channels work with size validators (not supported by most libraries)
- **CEL expressions**: Common Expression Language support for complex validation logic
- **Go zero-value semantics**: Proper handling of Go's zero values and nil states
- **Unicode-aware**: String validators properly handle Unicode characters

## 📊 Performance Comparison

<div align="center">

| Feature | govalid | Reflection Validators |
|:-------:|:-------:|:--------------------:|
| **Performance** | `~1-14ns, 0 allocs` | `~50-700ns, 0-5 allocs` |
| **Type Safety** | ✅ Compile-time | ❌ Runtime reflection |
| **Collections** | `slice, array, map, channel` | `slice, array only` |
| **Dependencies** | ✅ Minimal | ❌ Heavy runtime deps |
| **Error Detection** | ✅ Compile-time | ❌ Runtime |
| **CEL Support** | ✅ Full support | ❌ Limited/None |

</div>

## 📦 Installation

```bash
# Clone the repository
git clone https://github.com/sivchari/govalid.git

# Navigate to the project directory
cd govalid

# Install the tool
go install ./...
```

## 🎯 Quick Start

### 1. Define Your Struct
```go
// Add validation markers above your struct
// +govalid:required
type Person struct {
    Name  string `json:"name"`
    // +govalid:email
    Email string `json:"email"`
}
```

### 2. Generate Validation Code
```bash
govalid generate
```

This generates validation code like:

```go
// Code generated by govalid; DO NOT EDIT.

var (
    ErrNilPerson = errors.New("input Person is nil")
    ErrPersonNameRequiredValidation = errors.New("field Name is required")
    ErrPersonEmailEmailValidation = errors.New("field Email must be a valid email address")
)

func ValidatePerson(t *Person) error {
    if t == nil {
        return ErrNilPerson
    }
    if len(t.Name) == 0 {
        return ErrPersonNameRequiredValidation
    }
    if !validationhelper.IsValidEmail(t.Email) {
        return ErrPersonEmailEmailValidation
    }
    return nil
}
```

### 3. Use Generated Validators
```go
func main() {
    p := &Person{Name: "John", Email: "invalid-email"}
    
    if err := ValidatePerson(p); err != nil {
        log.Printf("Validation failed: %v", err)
        // Output: Validation failed: field Email must be a valid email address
    }
}
```

## 🔧 Advanced Features

### Struct-Level Validation
Apply validation rules to entire structs:

```go
// All fields will be validated as required
// +govalid:required
type Person struct {
    Name  string
    Email string
    Age   int
}
```

### CEL Expression Support
Use Common Expression Language for complex validation:

```go
type User struct {
    // +govalid:cel=value >= 18 && value <= 120
    Age int
    // +govalid:cel=value >= this.Age
    RetirementAge int
}
```

### Collection Support
Validate maps, channels, slices, and arrays:

```go
// +govalid:maxitems=10
type UserList struct {
    Users    []User           // slice support
    UserMap  map[string]User  // map support  
    UserChan chan User        // channel support
}
```

## 📝 Supported Markers

<details>
<summary><strong>📖 View Complete Marker Reference</strong></summary>

For a complete reference of all supported markers, see [MARKERS.md](MARKERS.md).

**Core Validators:**
- `required` - Field must not be zero value
- `gt`, `gte`, `lt`, `lte` - Numeric comparisons
- `maxlength`, `minlength` - String length validation
- `maxitems`, `minitems` - Collection size validation
- `enum` - Enumeration validation
- `email`, `url`, `uuid` - Format validation

**Advanced:**
- `cel` - Common Expression Language support
- Struct-level markers
- Custom validation logic

</details>

## 🚀 Performance Benchmarks

govalid consistently outperforms reflection-based validators by **5x to 44x**:

<div align="center">

| Validator | govalid | go-playground | Improvement |
|:---------:|:-------:|:-------------:|:-----------:|
| Required | `1.9ns` | `85.5ns` | **44.2x** |
| GT/LT | `1.9ns` | `63.0ns` | **32.5x** |
| MaxLength | `15.7ns` | `73.5ns` | **4.7x** |
| Email | `38.2ns` | `649.4ns` | **17.0x** |

*All with **0 allocations** vs competitors' 0-5 allocations*

</div>

[📊 View Complete Benchmarks](test/benchmark/README.md)

## 📄 License

MIT License - see [LICENSE](LICENSE) file for details.

---

<div align="center">
  <sub>Built with ❤️ for the Go community</sub>
</div>
